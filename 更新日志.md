# NewSSP软件
## pf - 2025-11-17
### 新增
- 无

### 更改
- vb将全局变量当作参数传递至函数中，在函数里实际上仍是全局变量，对CalcRhoTP函数传入的全局变量全部进行局部化，如 参数列表的TK 写成 tk，
  
  同时vb中CalcRhoTP函数存在修改参数列表参数（实际就是修改全局），因此在CalcRhoTP结束前，特意调用  TK = tk;  让全局的TK得到对应的修改。

### 修复
- CalcRhoTP存在的问题

## pf - 2025-11-16
### 新增
- 无

### 更改
- 无

### 修复
- C2_Pitzer2019内数组值的计算检查（CPhi,Lna,Tccp,Yccpa,Yaapc,Lnc）调试完成，计算无误，C2_Pitzer2019的调试告一段落

## pf - 2025-11-16
### 新增
- 无

### 更改
- C2_Pitzer2019等函数参数局部化，vb中虽然参数在参数列表，但实际上仍是全局的，对此造成了c语言计算错误，对此做出更改。
### 当前进度
 处于调用链B2->PartC->D1->D2(8067行)->CalcRhoTP, 4437行
### 修复
- 无

## pf - 2025-11-15
### 新增
- B1函数用于初始化

### 更改
- fBtermcalc的c疑似毫无用处，每次都是13，暂时int c = 13保留。

### 修复
- 无

## hzy - 2025-11-15
### 新增
- 无 

### 更改
- fBtermcalc中bterm计算的结果不一致，还需要重新排查C2_Pitzer2019的b0、b1、b2计算流程

### 修复
- 无

## pf - 2025-11-13
### 新增
- 无 

### 更改
- 无

### 修复
· ChCat和ChAn数组初始化，这两个数组在B1函数(更高一层)里赋值，CalcIonicStrength函数需要，因此在创建时直接给定B1里的值。

· 修复了V0TP里存在的错误。

· 修复了C2_Pitzer2019里存在的计算错误。

### 当前进度
 处于调用链B2->PartC->D1->D2(8067行)->CalcRhoTP，CalcRhoTP里，C2_Pitzer2019已经调试完成，当前处在4366行的AphiP = fAphicalc();


## pf - 2025-11-13
### 新增
- 新增两个变量double PipeID, PipeL; 目前用不到，仅作保留  

### 更改
- 开启了部分原先注释的代码，如fTPFunc

### 修复
- kk==1  -> kk==0

- 偏移：VwMix(1) -> VwMix[0]


## hzy- 2025-11-13

### 新增
- 无

### 更改
- 优化结构体SampleData注释，以及mockData_sheetInput

### 修复
- 无
## pf - 2025-11-12

### 新增
- 无

### 更改
- C2_PitzerActCoefs_T_P_ISt重复定义，已删除。

### 修复
- 修改原先的翻译错误，使数据和vb相同

- 偏移更新 ： errmsg[4] = 4 -> errmsg[3] = 4;//源码：errmsg(4) = 4;

- 修正了C2_PitzerActCoefs_T_P_ISt数组索引与某些变量名不规范的问题。

- 修正了void D1_CalcDensity调用C2_PitzerActCoefs_T_P_ISt时传入参数aH2O改为&aH2O。

## hzy- 2025-11-12

### 新增
- mockData_sheetInput:模拟sheetInput中的数据

### 更改
- 无

### 修复
- 无



## 调试步骤
使用Excel内置的编译器调试VB代码，之后一步步对照着完善C代码，逐步完成Excel VBA代码转换为C语言的任务。

调试准备：

1、搭建VBA调试环境：确保Excel可以运行和调试宏（**启用开发工具**，设置宏安全级别）。

2、使用VBA调试器：设置断点，使用 F8（逐语句） 单步执行，在本地窗口观察所有变量的值，记录下输入参数和准确的输出结果。

3、使用C调试器，如GDB，将C调试器中每一步的变量值（尤其是循环计数器、条件判断分支、中间计算结果）与之前在VBA调试器中记录的值进行逐行、逐变量对比，**使用 `printf` 大法**。

4、通过这种严谨的、一步一步对照的方法，最大可能的减少转换过程中引入的错误。

## 更新日志规范
版本格式
```md
## [name] - YYYY-MM-DD

### 新增
- 新功能描述

### 更改
- 现有功能变更

### 修复
- Bug修复描述
```

Github分支策略：
分支策略
```bash
# 1. 从main分支创建功能分支
git checkout -b feat/your-feature-name

# 2. 开发完成后提交
git add .
git commit -m "feat: 添加新功能描述"

# 3. 推送到远程
git push origin feat/your-feature-name

# 4. 创建Pull Request
```
提交信息规范:
```text
类型(范围): 描述

feat:     新功能
fix:      Bug修复
docs:     文档更新
style:    代码格式调整
refactor: 重构
test:     测试相关
chore:    构建过程或辅助工具变动
```

冲突解决策略

```bash
# 当出现冲突时
git fetch origin
git rebase origin/main
# 解决冲突后
git add .
git rebase --continue
git push -f origin your-branch
```

commit示例：

```bash
git checkout main
git pull origin main
git checkout -b feat/ReadInputPartC
git add .
git commit -m "feat: 实现Input表单的数据真实模拟，mockData_sheetInput"
```
push推送：
```bash
# 第一次推送时，需要设置上游分支
git push -u origin feat/user-login
# 之后推送，只需要
git push
```

如果要使用上一次的提交信息：
```bash
git commit --amend --no-edit
```
如果要修改上一次的提交信息：
```bash
git commit --amend
git commit -m "你的提交信息"
```

危险的使用场景：分支已经推送到远程，且其他成员可能已经拉取了该分支，在这种情况下强制推送 (git push --force) 会破坏其他人的工作

## 数据库函数pow计算操作过多
在涉及pow操作时，看是否能够优化计算流程，能提前计算的就先计算出来，减少pow操作。